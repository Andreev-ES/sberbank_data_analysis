{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Упражнение 1\n",
    "\n",
    "* Скачайте с портала Открытых Данных производственный календарь России: https://data.gov.ru/opendata/7708660670-proizvcalendar\n",
    "* На его основе определите соответствующий календарь в Pandas: `RussianBusinessCalendar(AbstractHolidayCalendar)`\n",
    "* С помощью полученного в пункте выше календаря и модуля `pd.offsets` создайте DataFrame one-hot календарных признаков:\n",
    "    * День недели\n",
    "    * Месяц\n",
    "    * Выходной день\n",
    "    * Праздничный день\n",
    "    * Предпраздничный рабочий день\n",
    "    * Последний день месяца\n",
    "    * Последний рабочий день месяца\n",
    "    * Предновогодний выходной день"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 86,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "import datetime as dt# для работы со временем \n",
    "\n",
    "import numpy as np # уже знакомые библиотеки\n",
    "import pandas as pd\n",
    "import matplotlib.pyplot as plt\n",
    "\n",
    "%matplotlib inline\n",
    "\n",
    "\n",
    "from pandas.tseries.holiday import AbstractHolidayCalendar, Holiday, nearest_workday, EasterMonday\n",
    "from pandas.tseries.offsets import DateOffset, Day"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 87,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Год/Месяц</th>\n",
       "      <th>Январь</th>\n",
       "      <th>Февраль</th>\n",
       "      <th>Март</th>\n",
       "      <th>Апрель</th>\n",
       "      <th>Май</th>\n",
       "      <th>Июнь</th>\n",
       "      <th>Июль</th>\n",
       "      <th>Август</th>\n",
       "      <th>Сентябрь</th>\n",
       "      <th>Октябрь</th>\n",
       "      <th>Ноябрь</th>\n",
       "      <th>Декабрь</th>\n",
       "      <th>Всего рабочих дней</th>\n",
       "      <th>Всего праздничных и выходных дней</th>\n",
       "      <th>Количество рабочих часов при 40-часовой рабочей неделе</th>\n",
       "      <th>Количество рабочих часов при 36-часовой рабочей неделе</th>\n",
       "      <th>Количество рабочих часов при 24-часовой рабочей неделе</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>2021</td>\n",
       "      <td>1,2,3,4,5,6,7,8,9,10,16,17,23,24,30,31</td>\n",
       "      <td>6,7,13,14,20,21,22*,23,27,28</td>\n",
       "      <td>6,7,8*,13,14,20,21,27,28</td>\n",
       "      <td>3,4,10,11,17,18,24,25,30*</td>\n",
       "      <td>1,2,3+,8,9,10+,15,16,22,23,29,30</td>\n",
       "      <td>5,6,11*,12,13,14+,19,20,26,27</td>\n",
       "      <td>3,4,10,11,17,18,24,25,31</td>\n",
       "      <td>1,7,8,14,15,21,22,28,29</td>\n",
       "      <td>4,5,11,12,18,19,25,26</td>\n",
       "      <td>2,3,9,10,16,17,23,24,30,31</td>\n",
       "      <td>3*,4,6,7,13,14,20,21,27,28</td>\n",
       "      <td>4,5,11,12,18,19,25,26,31*</td>\n",
       "      <td>249</td>\n",
       "      <td>116</td>\n",
       "      <td>1987</td>\n",
       "      <td>1787.8</td>\n",
       "      <td>1190.2</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    Год/Месяц                                  Январь  \\\n",
       "22       2021  1,2,3,4,5,6,7,8,9,10,16,17,23,24,30,31   \n",
       "\n",
       "                         Февраль                      Март  \\\n",
       "22  6,7,13,14,20,21,22*,23,27,28  6,7,8*,13,14,20,21,27,28   \n",
       "\n",
       "                       Апрель                               Май  \\\n",
       "22  3,4,10,11,17,18,24,25,30*  1,2,3+,8,9,10+,15,16,22,23,29,30   \n",
       "\n",
       "                             Июнь                      Июль  \\\n",
       "22  5,6,11*,12,13,14+,19,20,26,27  3,4,10,11,17,18,24,25,31   \n",
       "\n",
       "                     Август               Сентябрь  \\\n",
       "22  1,7,8,14,15,21,22,28,29  4,5,11,12,18,19,25,26   \n",
       "\n",
       "                       Октябрь                      Ноябрь  \\\n",
       "22  2,3,9,10,16,17,23,24,30,31  3*,4,6,7,13,14,20,21,27,28   \n",
       "\n",
       "                      Декабрь  Всего рабочих дней  \\\n",
       "22  4,5,11,12,18,19,25,26,31*                 249   \n",
       "\n",
       "    Всего праздничных и выходных дней  \\\n",
       "22                                116   \n",
       "\n",
       "    Количество рабочих часов при 40-часовой рабочей неделе  \\\n",
       "22                                               1987        \n",
       "\n",
       "    Количество рабочих часов при 36-часовой рабочей неделе  \\\n",
       "22                                             1787.8        \n",
       "\n",
       "    Количество рабочих часов при 24-часовой рабочей неделе  \n",
       "22                                             1190.2       "
      ]
     },
     "execution_count": 87,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "CalendarDf = pd.read_csv('data.csv')\n",
    "CalendarDf[CalendarDf['Год/Месяц'] == 2021]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 88,
   "metadata": {
    "scrolled": true
   },
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>month</th>\n",
       "      <th>year_number</th>\n",
       "      <th>holidays</th>\n",
       "      <th>month_number</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>22</th>\n",
       "      <td>Январь</td>\n",
       "      <td>2021</td>\n",
       "      <td>1,2,3,4,5,6,7,8,9,10,16,17,23,24,30,31</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>49</th>\n",
       "      <td>Февраль</td>\n",
       "      <td>2021</td>\n",
       "      <td>6,7,13,14,20,21,22*,23,27,28</td>\n",
       "      <td>2</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>76</th>\n",
       "      <td>Март</td>\n",
       "      <td>2021</td>\n",
       "      <td>6,7,8*,13,14,20,21,27,28</td>\n",
       "      <td>3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>103</th>\n",
       "      <td>Апрель</td>\n",
       "      <td>2021</td>\n",
       "      <td>3,4,10,11,17,18,24,25,30*</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>130</th>\n",
       "      <td>Май</td>\n",
       "      <td>2021</td>\n",
       "      <td>1,2,3+,8,9,10+,15,16,22,23,29,30</td>\n",
       "      <td>5</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>157</th>\n",
       "      <td>Июнь</td>\n",
       "      <td>2021</td>\n",
       "      <td>5,6,11*,12,13,14+,19,20,26,27</td>\n",
       "      <td>6</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>184</th>\n",
       "      <td>Июль</td>\n",
       "      <td>2021</td>\n",
       "      <td>3,4,10,11,17,18,24,25,31</td>\n",
       "      <td>7</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>211</th>\n",
       "      <td>Август</td>\n",
       "      <td>2021</td>\n",
       "      <td>1,7,8,14,15,21,22,28,29</td>\n",
       "      <td>8</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>238</th>\n",
       "      <td>Сентябрь</td>\n",
       "      <td>2021</td>\n",
       "      <td>4,5,11,12,18,19,25,26</td>\n",
       "      <td>9</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>265</th>\n",
       "      <td>Октябрь</td>\n",
       "      <td>2021</td>\n",
       "      <td>2,3,9,10,16,17,23,24,30,31</td>\n",
       "      <td>10</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>292</th>\n",
       "      <td>Ноябрь</td>\n",
       "      <td>2021</td>\n",
       "      <td>3*,4,6,7,13,14,20,21,27,28</td>\n",
       "      <td>11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>319</th>\n",
       "      <td>Декабрь</td>\n",
       "      <td>2021</td>\n",
       "      <td>4,5,11,12,18,19,25,26,31*</td>\n",
       "      <td>12</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "        month  year_number                                holidays  \\\n",
       "22     Январь         2021  1,2,3,4,5,6,7,8,9,10,16,17,23,24,30,31   \n",
       "49    Февраль         2021            6,7,13,14,20,21,22*,23,27,28   \n",
       "76       Март         2021                6,7,8*,13,14,20,21,27,28   \n",
       "103    Апрель         2021               3,4,10,11,17,18,24,25,30*   \n",
       "130       Май         2021        1,2,3+,8,9,10+,15,16,22,23,29,30   \n",
       "157      Июнь         2021           5,6,11*,12,13,14+,19,20,26,27   \n",
       "184      Июль         2021                3,4,10,11,17,18,24,25,31   \n",
       "211    Август         2021                 1,7,8,14,15,21,22,28,29   \n",
       "238  Сентябрь         2021                   4,5,11,12,18,19,25,26   \n",
       "265   Октябрь         2021              2,3,9,10,16,17,23,24,30,31   \n",
       "292    Ноябрь         2021              3*,4,6,7,13,14,20,21,27,28   \n",
       "319   Декабрь         2021               4,5,11,12,18,19,25,26,31*   \n",
       "\n",
       "     month_number  \n",
       "22              1  \n",
       "49              2  \n",
       "76              3  \n",
       "103             4  \n",
       "130             5  \n",
       "157             6  \n",
       "184             7  \n",
       "211             8  \n",
       "238             9  \n",
       "265            10  \n",
       "292            11  \n",
       "319            12  "
      ]
     },
     "execution_count": 88,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "data = CalendarDf[['Январь','Февраль','Март','Апрель','Май','Июнь','Июль','Август','Сентябрь','Октябрь','Ноябрь','Декабрь']]\n",
    "data =data.unstack().reset_index(name='holidays')\n",
    "data.rename(columns={'level_0': 'month', 'level_1': 'year_number'}, inplace=True)\n",
    "data['year_number'] = data['year_number'] + CalendarDf['Год/Месяц'].min()\n",
    "data_mn = pd.DataFrame({'month': ['Январь','Февраль','Март','Апрель','Май','Июнь','Июль','Август','Сентябрь','Октябрь','Ноябрь','Декабрь'], \n",
    "                        'month_number':np.arange(1,13)}) \n",
    "data = pd.merge(data, data_mn, left_on='month', right_on='month', how='inner')\n",
    "data[(data.year_number == 2021)]\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 89,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>holidays_date</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>1999-01-03</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  holidays_date\n",
       "2    1999-01-03"
      ]
     },
     "execution_count": 89,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "list_holidays_date=[]\n",
    "def holidays_day (row):    \n",
    "    y = str(row['year_number'])\n",
    "    m = ('0' + str(row['month_number']))[-2:] \n",
    "    list_days = row['holidays']\n",
    "    #list_d = list_days.replace('*','').replace('+','').split(',') \n",
    "    list_d = list_days.replace('+','').split(',') \n",
    "    for d in list_d:\n",
    "        if '*' not in d:\n",
    "            d = ('0' + d)[-2:]\n",
    "            list_holidays_date.append (pd.to_datetime(y + '-'  + m + '-' + d, format='%Y-%m-%d'))\n",
    "        \n",
    "data[['year_number','month_number','holidays']].apply(holidays_day, axis=1)\n",
    "list_holidays_date\n",
    "list_holidays_date_df = pd.DataFrame(list_holidays_date)\n",
    "list_holidays_date_df.columns = ['holidays_date']\n",
    "list_holidays_date_df[(list_holidays_date_df.holidays_date == '1999-01-03' )]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 90,
   "metadata": {
    "collapsed": true
   },
   "outputs": [],
   "source": [
    "from pandas.tseries.holiday import AbstractHolidayCalendar, Holiday, nearest_workday, EasterMonday\n",
    "from pandas.tseries.offsets import DateOffset, Day\n",
    "\n",
    "class RussianBusinessCalendar(AbstractHolidayCalendar):\n",
    "    start_date = dt.datetime(1999, 1, 1)\n",
    "    end_date = dt.datetime(2025, 12, 31)\n",
    "    rules = [\n",
    "                Holiday(name = 'Russian Day Off', month=d.month, day=d.day, year=d.year)\n",
    "                for d in list_holidays_date_df.holidays_date            \n",
    "            ]\n",
    "    \n",
    "russian_busday = pd.offsets.CustomBusinessDay(weekmask='Mon Tue Wed Thu Fri', \n",
    "                                              calendar=RussianBusinessCalendar())"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 91,
   "metadata": {
    "scrolled": false
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Program Files\\Anaconda3\\lib\\site-packages\\pandas\\core\\indexes\\datetimes.py:831: PerformanceWarning: Non-vectorized DateOffset being applied to Series or DatetimeIndex\n",
      "  \"or DatetimeIndex\", PerformanceWarning)\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style>\n",
       "    .dataframe thead tr:only-child th {\n",
       "        text-align: right;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: left;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>DATE</th>\n",
       "      <th>выходной</th>\n",
       "      <th>праздник</th>\n",
       "      <th>предпраздничный рабочий день</th>\n",
       "      <th>последний день месяца</th>\n",
       "      <th>последний рабочий день месяца</th>\n",
       "      <th>пн</th>\n",
       "      <th>вт</th>\n",
       "      <th>ср</th>\n",
       "      <th>чт</th>\n",
       "      <th>...</th>\n",
       "      <th>апрель</th>\n",
       "      <th>май</th>\n",
       "      <th>июнь</th>\n",
       "      <th>июль</th>\n",
       "      <th>август</th>\n",
       "      <th>сентябрь</th>\n",
       "      <th>октябрь</th>\n",
       "      <th>ноябрь</th>\n",
       "      <th>декабрь</th>\n",
       "      <th>Предновогодний выходной день</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>2020-03-01</th>\n",
       "      <td>2020-03-01</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-02</th>\n",
       "      <td>2020-03-02</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-03</th>\n",
       "      <td>2020-03-03</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-04</th>\n",
       "      <td>2020-03-04</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-05</th>\n",
       "      <td>2020-03-05</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-06</th>\n",
       "      <td>2020-03-06</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-07</th>\n",
       "      <td>2020-03-07</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-08</th>\n",
       "      <td>2020-03-08</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-09</th>\n",
       "      <td>2020-03-09</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-10</th>\n",
       "      <td>2020-03-10</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-11</th>\n",
       "      <td>2020-03-11</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-12</th>\n",
       "      <td>2020-03-12</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-13</th>\n",
       "      <td>2020-03-13</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-14</th>\n",
       "      <td>2020-03-14</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-15</th>\n",
       "      <td>2020-03-15</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-16</th>\n",
       "      <td>2020-03-16</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-17</th>\n",
       "      <td>2020-03-17</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-18</th>\n",
       "      <td>2020-03-18</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-19</th>\n",
       "      <td>2020-03-19</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-20</th>\n",
       "      <td>2020-03-20</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-21</th>\n",
       "      <td>2020-03-21</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-22</th>\n",
       "      <td>2020-03-22</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-23</th>\n",
       "      <td>2020-03-23</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-24</th>\n",
       "      <td>2020-03-24</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-25</th>\n",
       "      <td>2020-03-25</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-26</th>\n",
       "      <td>2020-03-26</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-27</th>\n",
       "      <td>2020-03-27</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-28</th>\n",
       "      <td>2020-03-28</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-29</th>\n",
       "      <td>2020-03-29</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-30</th>\n",
       "      <td>2020-03-30</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2020-03-31</th>\n",
       "      <td>2020-03-31</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>1</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>...</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "      <td>0</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>31 rows × 26 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "                 DATE  выходной  праздник  предпраздничный рабочий день  \\\n",
       "2020-03-01 2020-03-01         1         0                             0   \n",
       "2020-03-02 2020-03-02         0         0                             0   \n",
       "2020-03-03 2020-03-03         0         0                             0   \n",
       "2020-03-04 2020-03-04         0         0                             0   \n",
       "2020-03-05 2020-03-05         0         0                             0   \n",
       "2020-03-06 2020-03-06         0         0                             1   \n",
       "2020-03-07 2020-03-07         1         0                             0   \n",
       "2020-03-08 2020-03-08         1         1                             0   \n",
       "2020-03-09 2020-03-09         1         0                             0   \n",
       "2020-03-10 2020-03-10         0         0                             0   \n",
       "2020-03-11 2020-03-11         0         0                             0   \n",
       "2020-03-12 2020-03-12         0         0                             0   \n",
       "2020-03-13 2020-03-13         0         0                             0   \n",
       "2020-03-14 2020-03-14         1         0                             0   \n",
       "2020-03-15 2020-03-15         1         0                             0   \n",
       "2020-03-16 2020-03-16         0         0                             0   \n",
       "2020-03-17 2020-03-17         0         0                             0   \n",
       "2020-03-18 2020-03-18         0         0                             0   \n",
       "2020-03-19 2020-03-19         0         0                             0   \n",
       "2020-03-20 2020-03-20         0         0                             0   \n",
       "2020-03-21 2020-03-21         1         0                             0   \n",
       "2020-03-22 2020-03-22         1         0                             0   \n",
       "2020-03-23 2020-03-23         0         0                             0   \n",
       "2020-03-24 2020-03-24         0         0                             0   \n",
       "2020-03-25 2020-03-25         0         0                             0   \n",
       "2020-03-26 2020-03-26         0         0                             0   \n",
       "2020-03-27 2020-03-27         0         0                             0   \n",
       "2020-03-28 2020-03-28         1         0                             0   \n",
       "2020-03-29 2020-03-29         1         0                             0   \n",
       "2020-03-30 2020-03-30         0         0                             0   \n",
       "2020-03-31 2020-03-31         0         0                             0   \n",
       "\n",
       "            последний день месяца  последний рабочий день месяца  пн  вт  ср  \\\n",
       "2020-03-01                      0                              0   0   0   0   \n",
       "2020-03-02                      0                              0   1   0   0   \n",
       "2020-03-03                      0                              0   0   1   0   \n",
       "2020-03-04                      0                              0   0   0   1   \n",
       "2020-03-05                      0                              0   0   0   0   \n",
       "2020-03-06                      0                              0   0   0   0   \n",
       "2020-03-07                      0                              0   0   0   0   \n",
       "2020-03-08                      0                              0   0   0   0   \n",
       "2020-03-09                      0                              0   1   0   0   \n",
       "2020-03-10                      0                              0   0   1   0   \n",
       "2020-03-11                      0                              0   0   0   1   \n",
       "2020-03-12                      0                              0   0   0   0   \n",
       "2020-03-13                      0                              0   0   0   0   \n",
       "2020-03-14                      0                              0   0   0   0   \n",
       "2020-03-15                      0                              0   0   0   0   \n",
       "2020-03-16                      0                              0   1   0   0   \n",
       "2020-03-17                      0                              0   0   1   0   \n",
       "2020-03-18                      0                              0   0   0   1   \n",
       "2020-03-19                      0                              0   0   0   0   \n",
       "2020-03-20                      0                              0   0   0   0   \n",
       "2020-03-21                      0                              0   0   0   0   \n",
       "2020-03-22                      0                              0   0   0   0   \n",
       "2020-03-23                      0                              0   1   0   0   \n",
       "2020-03-24                      0                              0   0   1   0   \n",
       "2020-03-25                      0                              0   0   0   1   \n",
       "2020-03-26                      0                              0   0   0   0   \n",
       "2020-03-27                      0                              0   0   0   0   \n",
       "2020-03-28                      0                              0   0   0   0   \n",
       "2020-03-29                      0                              0   0   0   0   \n",
       "2020-03-30                      0                              0   1   0   0   \n",
       "2020-03-31                      1                              1   0   1   0   \n",
       "\n",
       "            чт              ...               апрель  май  июнь  июль  август  \\\n",
       "2020-03-01   0              ...                    0    0     0     0       0   \n",
       "2020-03-02   0              ...                    0    0     0     0       0   \n",
       "2020-03-03   0              ...                    0    0     0     0       0   \n",
       "2020-03-04   0              ...                    0    0     0     0       0   \n",
       "2020-03-05   1              ...                    0    0     0     0       0   \n",
       "2020-03-06   0              ...                    0    0     0     0       0   \n",
       "2020-03-07   0              ...                    0    0     0     0       0   \n",
       "2020-03-08   0              ...                    0    0     0     0       0   \n",
       "2020-03-09   0              ...                    0    0     0     0       0   \n",
       "2020-03-10   0              ...                    0    0     0     0       0   \n",
       "2020-03-11   0              ...                    0    0     0     0       0   \n",
       "2020-03-12   1              ...                    0    0     0     0       0   \n",
       "2020-03-13   0              ...                    0    0     0     0       0   \n",
       "2020-03-14   0              ...                    0    0     0     0       0   \n",
       "2020-03-15   0              ...                    0    0     0     0       0   \n",
       "2020-03-16   0              ...                    0    0     0     0       0   \n",
       "2020-03-17   0              ...                    0    0     0     0       0   \n",
       "2020-03-18   0              ...                    0    0     0     0       0   \n",
       "2020-03-19   1              ...                    0    0     0     0       0   \n",
       "2020-03-20   0              ...                    0    0     0     0       0   \n",
       "2020-03-21   0              ...                    0    0     0     0       0   \n",
       "2020-03-22   0              ...                    0    0     0     0       0   \n",
       "2020-03-23   0              ...                    0    0     0     0       0   \n",
       "2020-03-24   0              ...                    0    0     0     0       0   \n",
       "2020-03-25   0              ...                    0    0     0     0       0   \n",
       "2020-03-26   1              ...                    0    0     0     0       0   \n",
       "2020-03-27   0              ...                    0    0     0     0       0   \n",
       "2020-03-28   0              ...                    0    0     0     0       0   \n",
       "2020-03-29   0              ...                    0    0     0     0       0   \n",
       "2020-03-30   0              ...                    0    0     0     0       0   \n",
       "2020-03-31   0              ...                    0    0     0     0       0   \n",
       "\n",
       "            сентябрь  октябрь  ноябрь  декабрь  Предновогодний выходной день  \n",
       "2020-03-01         0        0       0        0                             0  \n",
       "2020-03-02         0        0       0        0                             0  \n",
       "2020-03-03         0        0       0        0                             0  \n",
       "2020-03-04         0        0       0        0                             0  \n",
       "2020-03-05         0        0       0        0                             0  \n",
       "2020-03-06         0        0       0        0                             0  \n",
       "2020-03-07         0        0       0        0                             0  \n",
       "2020-03-08         0        0       0        0                             0  \n",
       "2020-03-09         0        0       0        0                             0  \n",
       "2020-03-10         0        0       0        0                             0  \n",
       "2020-03-11         0        0       0        0                             0  \n",
       "2020-03-12         0        0       0        0                             0  \n",
       "2020-03-13         0        0       0        0                             0  \n",
       "2020-03-14         0        0       0        0                             0  \n",
       "2020-03-15         0        0       0        0                             0  \n",
       "2020-03-16         0        0       0        0                             0  \n",
       "2020-03-17         0        0       0        0                             0  \n",
       "2020-03-18         0        0       0        0                             0  \n",
       "2020-03-19         0        0       0        0                             0  \n",
       "2020-03-20         0        0       0        0                             0  \n",
       "2020-03-21         0        0       0        0                             0  \n",
       "2020-03-22         0        0       0        0                             0  \n",
       "2020-03-23         0        0       0        0                             0  \n",
       "2020-03-24         0        0       0        0                             0  \n",
       "2020-03-25         0        0       0        0                             0  \n",
       "2020-03-26         0        0       0        0                             0  \n",
       "2020-03-27         0        0       0        0                             0  \n",
       "2020-03-28         0        0       0        0                             0  \n",
       "2020-03-29         0        0       0        0                             1  \n",
       "2020-03-30         0        0       0        0                             0  \n",
       "2020-03-31         0        0       0        0                             0  \n",
       "\n",
       "[31 rows x 26 columns]"
      ]
     },
     "execution_count": 91,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "def month_of_year(month, number_month):\n",
    "    if month == number_month:\n",
    "        return 1\n",
    "    else:\n",
    "        return 0\n",
    "def holidays (d):\n",
    "    day_holidays_list = ['0101','0308','0223','0612']\n",
    "    if d.strftime(format='%m%d') in day_holidays_list:\n",
    "        return 1\n",
    "    else:\n",
    "        return 0\n",
    "      \n",
    "            \n",
    "month_list = ['январь','февраль','март','апрель','май','июнь','июль','август','сентябрь','октябрь','ноябрь','декабрь']\n",
    "day_week_list = ['пн','вт','ср','чт','пт','сб','вс']\n",
    "\n",
    "\n",
    "Calendar = pd.DataFrame(pd.Series(pd.date_range('1999-01-01', '2025-12-31', freq='D'), \n",
    "                        index=pd.date_range('1999-01-01', '2025-12-31', freq='D')))\n",
    "Calendar.columns = ['DATE']\n",
    "Calendar['выходной'] = (Calendar['DATE'] + russian_busday != Calendar['DATE'] +pd.offsets.Day() ).shift(1).fillna(0).astype(int)\n",
    "Calendar['праздник'] = Calendar['DATE'].apply(holidays)\n",
    "Calendar['предпраздничный рабочий день'] = 0\n",
    "\n",
    "for i in Calendar[(Calendar['праздник'] == 1) & (Calendar['DATE'] != '1999-01-01')].index:\n",
    "    if (i.weekday() in (5,6,0)):\n",
    "        i2 = i - pd.offsets.Week(weekday = 4)\n",
    "        Calendar.loc[i2, 'предпраздничный рабочий день'] = 1        \n",
    "    else:\n",
    "        Calendar.loc[i - pd.offsets.Day(), 'предпраздничный рабочий день'] = 1\n",
    "        \n",
    "Calendar['последний день месяца'] = (Calendar['DATE'] + pd.offsets.MonthEnd(0) == Calendar['DATE']).astype(int)\n",
    "Calendar['последний рабочий день месяца'] = ((Calendar['DATE'] + pd.offsets.MonthEnd(0)).apply(lambda x: x - pd.offsets.Week(weekday = 4) if x.weekday() in [5,6] else x) == Calendar['DATE']).astype(int)    \n",
    "\n",
    "for i,d in enumerate(day_week_list):\n",
    "    Calendar[d] = (Calendar['DATE'] - pd.offsets.Week(weekday = i) + 7 * pd.offsets.Day() == Calendar['DATE']).astype(int)\n",
    "for i,m in enumerate(month_list):\n",
    "    Calendar[m] = Calendar['DATE'].apply(lambda x: month_of_year(x.month,i+1))\n",
    "    \n",
    "Calendar['Предновогодний выходной день'] = ((Calendar['DATE'] + pd.offsets.MonthEnd(0)).apply(lambda x: x  if x.weekday() in [5,6] else x - pd.offsets.Week(weekday = 6)) == Calendar['DATE']).astype(int)    \n",
    "\n",
    "\n",
    "Calendar['2020-03']"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.6.1"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
